{"paragraphs":[{"text":"val bankText = sc.textFile(\"data/bank-full.csv\")\r\n\r\ncase class Bank(age:Integer, job:String, marital : String, education : String, balance : Integer)\r\n\r\n// split each line, filter out header (starts with \"age\"), and map it into Bank case class\r\nval headData = bankText.map(s=>s.split(\";\")).first()\r\nprint(\"\")\r\nprint(\"\\n headData : \" + headData)\r\n\r\nval firstData = bankText.map(s=>s.split(\";\")).filter(s=>s(0)!=\"\\\"age\\\"\").first()\r\nprint(\"\")\r\nprint(\"firstData : \" + firstData)\r\n\r\nval bank = bankText.map(s=>s.split(\";\")).filter(s=>s(0)!=\"\\\"age\\\"\").map(\r\n    s=>Bank(s(0).toInt, \r\n            s(1).replaceAll(\"\\\"\", \"\"),\r\n            s(2).replaceAll(\"\\\"\", \"\"),\r\n            s(3).replaceAll(\"\\\"\", \"\"),\r\n            s(5).replaceAll(\"\\\"\", \"\").toInt\r\n        )\r\n)\r\n\r\n// convert to DataFrame and create temporal table\r\nbank.toDF().registerTempTable(\"bank\")","dateUpdated":"2016-08-08T19:07:45+0900","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470622200709_806861496","id":"20160808-104301_1927106756","result":{"code":"SUCCESS","type":"TEXT","msg":"bankText: org.apache.spark.rdd.RDD[String] = data/bank-full.csv MapPartitionsRDD[1] at textFile at <console>:29\ndefined class Bank\nheadData: Array[String] = Array(\"age\", \"job\", \"marital\", \"education\", \"default\", \"balance\", \"housing\", \"loan\", \"contact\", \"day\", \"month\", \"duration\", \"campaign\", \"pdays\", \"previous\", \"poutcome\", \"y\")\n\n headData : [Ljava.lang.String;@3322d684firstData: Array[String] = Array(58, \"management\", \"married\", \"tertiary\", \"no\", 2143, \"yes\", \"no\", \"unknown\", 5, \"may\", 261, 1, -1, 0, \"unknown\", \"no\")\nfirstData : [Ljava.lang.String;@f6a9b75bank: org.apache.spark.rdd.RDD[Bank] = MapPartitionsRDD[7] at map at <console>:33\n"},"dateCreated":"2016-08-08T11:10:00+0900","dateStarted":"2016-08-08T19:07:45+0900","dateFinished":"2016-08-08T19:08:24+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:111"},{"text":"%sql \nselect age, count(1) value\nfrom bank \nwhere age < 30 \ngroup by age \norder by age","dateUpdated":"2016-08-08T19:08:32+0900","config":{"colWidth":4,"editorHide":false,"tableHide":false,"graph":{"mode":"multiBarChart","height":358,"optionOpen":false,"keys":[{"name":"age","index":0,"aggr":"sum"}],"values":[{"name":"value","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"age","index":0,"aggr":"sum"},"yAxis":{"name":"value","index":1,"aggr":"sum"}},"forceY":false,"lineWithFocus":false},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470622200709_806861496","id":"20160808-104532_448888682","result":{"code":"SUCCESS","type":"TABLE","msg":"age\tvalue\n18\t12\n19\t35\n20\t50\n21\t79\n22\t129\n23\t202\n24\t302\n25\t527\n26\t805\n27\t909\n28\t1038\n29\t1185\n","comment":"","msgTable":[[{"key":"value","value":"18"},{"key":"value","value":"12"}],[{"value":"19"},{"value":"35"}],[{"value":"20"},{"value":"50"}],[{"value":"21"},{"value":"79"}],[{"value":"22"},{"value":"129"}],[{"value":"23"},{"value":"202"}],[{"value":"24"},{"value":"302"}],[{"value":"25"},{"value":"527"}],[{"value":"26"},{"value":"805"}],[{"value":"27"},{"value":"909"}],[{"value":"28"},{"value":"1038"}],[{"value":"29"},{"value":"1185"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"value","index":1,"aggr":"sum"}],"rows":[["18","12"],["19","35"],["20","50"],["21","79"],["22","129"],["23","202"],["24","302"],["25","527"],["26","805"],["27","909"],["28","1038"],["29","1185"]]},"dateCreated":"2016-08-08T11:10:00+0900","dateStarted":"2016-08-08T19:08:33+0900","dateFinished":"2016-08-08T19:08:36+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:112"},{"text":"%sql \nselect age, count(1) value \nfrom bank \nwhere age < ${maxAge=35} \ngroup by age \norder by age","dateUpdated":"2016-08-08T19:08:38+0900","config":{"colWidth":4,"graph":{"mode":"multiBarChart","height":282,"optionOpen":false,"keys":[{"name":"age","index":0,"aggr":"sum"}],"values":[{"name":"value","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"age","index":0,"aggr":"sum"},"yAxis":{"name":"value","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{"maxAge":"40"},"forms":{"maxAge":{"name":"maxAge","defaultValue":"35","hidden":false}}},"jobName":"paragraph_1470622200709_806861496","id":"20160808-105016_332710051","result":{"code":"SUCCESS","type":"TABLE","msg":"age\tvalue\n18\t12\n19\t35\n20\t50\n21\t79\n22\t129\n23\t202\n24\t302\n25\t527\n26\t805\n27\t909\n28\t1038\n29\t1185\n30\t1757\n31\t1996\n32\t2085\n33\t1972\n34\t1930\n35\t1894\n36\t1806\n37\t1696\n38\t1466\n39\t1487\n","comment":"","msgTable":[[{"key":"value","value":"18"},{"key":"value","value":"12"}],[{"value":"19"},{"value":"35"}],[{"value":"20"},{"value":"50"}],[{"value":"21"},{"value":"79"}],[{"value":"22"},{"value":"129"}],[{"value":"23"},{"value":"202"}],[{"value":"24"},{"value":"302"}],[{"value":"25"},{"value":"527"}],[{"value":"26"},{"value":"805"}],[{"value":"27"},{"value":"909"}],[{"value":"28"},{"value":"1038"}],[{"value":"29"},{"value":"1185"}],[{"value":"30"},{"value":"1757"}],[{"value":"31"},{"value":"1996"}],[{"value":"32"},{"value":"2085"}],[{"value":"33"},{"value":"1972"}],[{"value":"34"},{"value":"1930"}],[{"value":"35"},{"value":"1894"}],[{"value":"36"},{"value":"1806"}],[{"value":"37"},{"value":"1696"}],[{"value":"38"},{"value":"1466"}],[{"value":"39"},{"value":"1487"}]],"columnNames":[{"name":"age","index":0,"aggr":"sum"},{"name":"value","index":1,"aggr":"sum"}],"rows":[["18","12"],["19","35"],["20","50"],["21","79"],["22","129"],["23","202"],["24","302"],["25","527"],["26","805"],["27","909"],["28","1038"],["29","1185"],["30","1757"],["31","1996"],["32","2085"],["33","1972"],["34","1930"],["35","1894"],["36","1806"],["37","1696"],["38","1466"],["39","1487"]]},"dateCreated":"2016-08-08T11:10:00+0900","dateStarted":"2016-08-08T19:08:38+0900","dateFinished":"2016-08-08T19:08:38+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:113"},{"text":"%sql \nselect marital, count(1) value \nfrom bank \n--where marital=\"${marital=single,single|divorced|married}\" \ngroup by marital \norder by value","dateUpdated":"2016-08-08T19:08:41+0900","config":{"colWidth":4,"graph":{"mode":"pieChart","height":278,"optionOpen":false,"keys":[{"name":"marital","index":0,"aggr":"sum"}],"values":[{"name":"value","index":1,"aggr":"sum"}],"groups":[],"scatter":{"yAxis":{"name":"value","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{"marital":"single"},"forms":{"marital":{"name":"marital","defaultValue":"single","options":[{"value":"single","$$hashKey":"object:367"},{"value":"divorced","$$hashKey":"object:368"},{"value":"married","$$hashKey":"object:369"}],"hidden":false}}},"jobName":"paragraph_1470622200710_808015743","id":"20160808-105613_1558526561","result":{"code":"SUCCESS","type":"TABLE","msg":"marital\tvalue\ndivorced\t5207\nsingle\t12790\nmarried\t27214\n","comment":"","msgTable":[[{"key":"value","value":"divorced"},{"key":"value","value":"5207"}],[{"value":"single"},{"value":"12790"}],[{"value":"married"},{"value":"27214"}]],"columnNames":[{"name":"marital","index":0,"aggr":"sum"},{"name":"value","index":1,"aggr":"sum"}],"rows":[["divorced","5207"],["single","12790"],["married","27214"]]},"dateCreated":"2016-08-08T11:10:00+0900","dateStarted":"2016-08-08T19:08:41+0900","dateFinished":"2016-08-08T19:08:42+0900","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:114"},{"dateUpdated":"2016-08-08T11:10:00+0900","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470622200710_808015743","id":"20160808-105613_441359054","dateCreated":"2016-08-08T11:10:00+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:115"},{"dateUpdated":"2016-08-08T11:10:00+0900","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470622200711_807630994","id":"20160808-105552_727561345","dateCreated":"2016-08-08T11:10:00+0900","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:116"}],"name":"T1_localFile","id":"2BU82P927","angularObjects":{"2BVFR7UG5:shared_process":[],"2BVA8NTYN:shared_process":[],"2BU1F5A61:shared_process":[],"2BT2KDKZR:shared_process":[],"2BTRD5C4Y:shared_process":[],"2BTTU1NSF:shared_process":[],"2BUFCHSDF:shared_process":[],"2BS1PT2SP:shared_process":[],"2BUEZ5FW8:shared_process":[],"2BSD25DB2:shared_process":[],"2BTQHASRE:shared_process":[],"2BT9Q23AM:shared_process":[],"2BU1BQKDA:shared_process":[],"2BUY99BCQ:shared_process":[],"2BUEYSHEP:shared_process":[],"2BV8XJSMT:shared_process":[],"2BRWCQHFF:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}